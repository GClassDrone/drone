<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.gclass.drone.mapper.MemMapper">

<!-- 가입시 받는 값 -->
	<insert id="insert">
		insert into mem(mno, niknm, email, pic,locno, ppose, siteno, siteid)
		values(mem_next,#{niknm},#{email}, #{pic},#{locno},#{ppose},#{siteno},#{siteid})
	</insert>
	
<!-- 로그인 확인 -->
	<select id="login" resultType="MemDto">
		select * 
		from mem 
		where siteno = #{siteno} and siteid = #{siteid}
	</select>
<!-- 중복확인 -->	
	<select id="dulogin" resultType="int">
		select count(niknm)
		  from mem
		 where niknm = #{niknm}
	</select>


<!--프로필 상세 페이지볼 때 읽어오는 값들 -->

	<select id="read" resultType="MemDto">
		select *
		from vw_mem
		where mno= #{mno}
	</select>


<!-- 프로필 수정할때 수정가능한 값들 -->
	<update id="update">
		update vw_mem set email=#{email}, pic=#{pic}, license=#{license}, msgrcyn=#{license}, prmsg=#{prmsg},
				locno=#{locno}, locnm=#{locnm}, mdrnm=#{mdrnm}, actnm=#{actnm}
		where mno = #{mno}
	</update>

<!-- 삭제시에 삭제는 멤버 넘버로 -->
	<delete id="delete">
		delete from mem where mno = #{mno}
	</delete>
	
	<!-- 프로필 리스트 불러오기 -->
	
<!-- 	<select id="listAll" resultType="MemDto">
		select *
		  from (
				select rownum as rnum, a.* 
				  from (
						select /*+ index_desc(mem mem_mno_pk) */ *
						  from mem
					   ) a 
		<![CDATA[
				 where rownum <= #{endRowNum}
			   ) b
		 where rnum >= #{startRowNum}
		]]>
	</select> -->
	
	<select id="listAll" resultType="MemDto">
		select *
		  from vw_mem
		 where mno>0
		 order by mno desc
	</select>
	
	<!-- 프로필 디테일부분에서 자기가 올린 컨텐츠를 불러오는 쿼리 -->
	
	<select id="conlist" resultType="MemDto">
	  select /*+ index_desc(cts idx_cts_regdt) */ *
        FROM cts
       WHERE mno = #{mno}
	</select>
	
</mapper>